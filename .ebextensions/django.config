option_settings:
  aws:elasticbeanstalk:container:python:
    WSGIPath: gifts_project.wsgi:application

  aws:elasticbeanstalk:application:environment:
    DJANGO_SETTINGS_MODULE: gifts_project.settings
    PYTHONPATH: "/var/app/venv/staging-LQM1lest/lib/python3.11/site-packages"
    MYSQL_DB_NAME: "gift-database"
    MYSQL_DB_USER: "admin"
    MYSQL_DB_PASSWORD: "rdsdbpass"
    MYSQL_DB_HOST: "gift-database.c7dkpauvymhwz.us-west-2.rds.amazonaws.com"

container_commands:
  01_activate:
    command: "source /var/app/venv/staging-LQM1lest/bin/activate"
  02_install_AWS_packages:
    command: "sudo yum install -y python3-devel mariadb105-devel"
  02b_install_mysql
    command: "pip install mysql-devel"
  03_install_requirements_txt:
    command: "pip install -r /var/app/staging/gifts-backend/requirements.txt"
  04_reactivate_and_migrate:
    command: "source /var/app/venv/staging-LQM1lest/bin/activate && cd /var/app/staging/gifts-backend && python manage.py migrate"
  05_collectstatic:
    command: "python manage.py collectstatic --noinput"